class DragAndDrop{constructor({targetElementSelector:e,dropZoneSelector:t=`.${this.getNameSelector(e)}-drop-zone`,moveClass:o=this.getNameSelector(e)+"-move",selectClass:l=this.getNameSelector(e)+"-select",illuminationClass:n=this.getNameSelector(e)+"-illumination"}){this.targetElementSelector=e,this.elementMove,this.cloneElementMove,this.moveClass=o,this.dropZoneSelector=t,this.elementsDropZone=document.querySelectorAll(t),this.dropZoneHoverElement,this.isTouch=this.is_touch_enabled(),this.elementSelect,this.selectClass=l,this.illuminationClassDropZone=n,this.enableEventsDnD()}checkAreaDropZone=e=>{var t=e.pageX,o=e.pageY;for(let e=0;e<this.elementsDropZone.length;e++){var l=this.elementsDropZone[e].getBoundingClientRect(),n=this.getCoords(this.elementsDropZone[e]);if(t>=n.left&&t<=n.left+l.width&&o>=n.top&&o<=n.top+l.height){for(let e=0;e<this.elementsDropZone.length;e++)this.elementsDropZone[e].classList.remove("hover");this.elementsDropZone[e].classList.add("hover"),this.dropZoneHoverElement=this.elementsDropZone[e];break}this.elementsDropZone[e].classList.remove("hover"),this.dropZoneHoverElement=null}};pasteElementToDropZone(){var e=this.elementMove.cloneNode();this.dropZoneHoverElement.append(e),this.dropZoneHoverElement.classList.remove("hover"),this.createCustomEvent(e)}createCustomEvent(e){var t=new Event("drop-element-dnd",{bubbles:!0});e.dispatchEvent(t)}enableIlluminationDropZones(){this.elementsDropZone.forEach(e=>{e.classList.add(this.illuminationClassDropZone)})}disableIlluminationDropZones(){this.elementsDropZone.forEach(e=>{e.classList.remove(this.illuminationClassDropZone)})}movementProcessing=e=>{let t,o;if("mousemove"===e.type){t=e.clientX,o=e.clientY;e=window.innerHeight;if(t<0+this.cloneElementMove.offsetWidth/2&&o<0+this.cloneElementMove.offsetWidth/2)return this.cloneElementMove.style.left=0-this.cloneElementMove.offsetWidth/2+"px",void(this.cloneElementMove.style.top=0-this.cloneElementMove.offsetHeight/2+"px");if(t<0+this.cloneElementMove.offsetWidth/2&&o>e-this.cloneElementMove.offsetWidth/2)return this.cloneElementMove.style.left=0-this.cloneElementMove.offsetWidth/2+"px",void(this.cloneElementMove.style.top=e-this.cloneElementMove.offsetHeight/2+"px");if(o<0+this.cloneElementMove.offsetWidth/2&&t>window.innerWidth-this.cloneElementMove.offsetWidth/2)return this.cloneElementMove.style.left=window.innerWidth-this.cloneElementMove.offsetWidth/2+"px",void(this.cloneElementMove.style.top=0-this.cloneElementMove.offsetHeight/2+"px");if(t>window.innerWidth-this.cloneElementMove.offsetWidth/2&&o>e-this.cloneElementMove.offsetWidth/2)return this.cloneElementMove.style.left=window.innerWidth-this.cloneElementMove.offsetWidth/2+"px",void(this.cloneElementMove.style.top=e-this.cloneElementMove.offsetHeight/2+"px");if(t<0+this.cloneElementMove.offsetWidth/2)return this.cloneElementMove.style.left=0-this.cloneElementMove.offsetWidth/2+"px",void(this.cloneElementMove.style.top=o-this.cloneElementMove.offsetHeight/2+"px");if(o<0+this.cloneElementMove.offsetWidth/2)return this.cloneElementMove.style.left=t-this.cloneElementMove.offsetWidth/2+"px",void(this.cloneElementMove.style.top=0-this.cloneElementMove.offsetHeight/2+"px");if(t>window.innerWidth-this.cloneElementMove.offsetWidth/2)return this.cloneElementMove.style.left=window.innerWidth-this.cloneElementMove.offsetWidth/2+"px",void(this.cloneElementMove.style.top=o-this.cloneElementMove.offsetHeight/2+"px");if(o>e-this.cloneElementMove.offsetWidth/2)return this.cloneElementMove.style.left=t-this.cloneElementMove.offsetWidth/2+"px",void(this.cloneElementMove.style.top=e-this.cloneElementMove.offsetHeight/2+"px")}this.cloneElementMove.style.left=t-this.cloneElementMove.offsetWidth/2+"px",this.cloneElementMove.style.top=o-this.cloneElementMove.offsetHeight/2+"px"};enableEventMouse(){document.onmousedown=e=>{0===e.button&&e.target.closest(this.targetElementSelector)&&(this.elementMove=e.target,this.cloneElementMove||this.createCloneElement(),this.enableIlluminationDropZones(),document.onmousemove=e=>{this.movementProcessing(e),this.checkAreaDropZone(e)})},document.onmouseup=()=>{document.onmousemove=null,console.log(this.elementMove),console.log(this.dropZoneHoverElement),this.elementMove&&this.dropZoneHoverElement&&this.pasteElementToDropZone(),this.RemoveMoveElement(),this.disableIlluminationDropZones()}}enableEventTouch(){document.addEventListener("click",e=>{var t;e.target.closest(this.targetElementSelector)&&!e.target.closest(this.dropZoneSelector)?(this.elementSelect&&(this.elementSelect.classList.remove(this.selectClass),this.elementSelect=null,this.disableIlluminationDropZones()),this.elementSelect=e.target.closest(this.targetElementSelector),this.elementSelect.classList.add(this.selectClass),this.enableIlluminationDropZones()):e.target.closest(this.dropZoneSelector)?this.elementSelect&&(this.elementSelect.classList.remove(this.selectClass),t=this.elementSelect.cloneNode(),e.target.closest(this.dropZoneSelector).append(t),this.elementSelect=null,this.disableIlluminationDropZones(),this.createCustomEvent(t)):(this.elementSelect&&(this.elementSelect.classList.remove(this.selectClass),this.elementSelect=null),this.disableIlluminationDropZones())})}RemoveMoveElement=()=>{this.elementMove=null,this.cloneElementMove&&(this.cloneElementMove.remove(),this.cloneElementMove=null)};createCloneElement(){var e=this.getCoords(this.elementMove);this.cloneElementMove=this.elementMove.cloneNode(!0),this.cloneElementMove.setAttribute("data-id",this.guid()),this.cloneElementMove.classList.add(this.moveClass),this.cloneElementMove.style.position="fixed",this.cloneElementMove.style.left=e.left+"px",this.cloneElementMove.style.top=e.top+"px",document.body.appendChild(this.cloneElementMove)}enableEventNoDnDHTML(){document.querySelectorAll(this.targetElementSelector).forEach(e=>{e.setAttribute("draggable",!1)}),document.ondragstart=e=>{console.log(e);var t="."===this.targetElementSelector[0]||"#"===this.targetElementSelector[0]?this.targetElementSelector.substring(1,this.targetElementSelector.length):this.targetElementSelector;if(e.target.classList&&e.target.classList.contains(t))return console.log("dragstart false"),!1}}enableEventsDnD(){this.enableEventNoDnDHTML(),this.isTouch?this.enableEventTouch():this.enableEventMouse()}guid(){return([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,e=>(e^crypto.getRandomValues(new Uint8Array(1))[0]&15>>e/4).toString(16))}getCoords(e){var e=e.getBoundingClientRect(),t=document.body,o=document.documentElement,l=window.pageYOffset||o.scrollTop||t.scrollTop,n=window.pageXOffset||o.scrollLeft||t.scrollLeft,s=o.clientTop||t.clientTop||0,o=o.clientLeft||t.clientLeft||0,t=e.top+l-s,l=e.left+n-o;return{top:Math.round(t),left:Math.round(l)}}getNameSelector(e){return"."===e[0]||"#"===e[0]?e.substring(1,e.length):e}is_touch_enabled(){return"ontouchstart"in window||0<navigator.maxTouchPoints||0<navigator.msMaxTouchPoints}}